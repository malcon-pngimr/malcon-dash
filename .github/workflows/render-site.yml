name: Render site

on:
  schedule:
  - cron: "0 0 * * *" # at the end of everyday
  push:
    branches: [ main ]
jobs:
  build:
    name: render dashboard site
    runs-on: ubuntu-18.04 
    container: 
     image: myominnoo/dashboard:malcon0.3
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v2
        with: 
          ref: 'main'
      - name: Render scripts and build site
        run: |
            bash ./scripts/data_refresh.sh "main" "$PAT_KEY"
        env:     
          PAT_KEY: ${{ secrets.PAT_KEY }} 
      
      - name: Commit changes
        uses: EndBug/add-and-commit@v8
        with:
          author_name: Myo Minn Oo
          author_email: dr.myominnoo@gmail.com
          message: 'Auto pull of the HFS data on $(date)'
          add: '*'